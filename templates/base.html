<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="description" content="{{ config.site_description if config else 'Научный портал с интерактивными инструментами' }}">
    <meta name="theme-color" content="#3b82f6">
    <title>{% block title %}{{ config.site_title if config else 'Science Portal' }}{% endblock %}</title>
    <link rel="icon" type="image/png" href="{{ config.site_logo_dark if config and config.site_logo_dark else '/static/images/logo-dark.png' }}">
    <link rel="apple-touch-icon" href="{{ config.site_logo_dark if config and config.site_logo_dark else '/static/images/logo-dark.png' }}">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/plugins.css') }}">
    {% block extra_css %}{% endblock %}
</head>
<body>
    <div id="app">
        {% block header %}{% endblock %}
        {% block content %}{% endblock %}
    </div>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
    <script>
        const siteConfig = {
            logoLight: '{{ config.site_logo_light if config and config.site_logo_light else "/static/images/logo-light.png" }}',
            logoDark: '{{ config.site_logo_dark if config and config.site_logo_dark else "/static/images/logo-dark.png" }}',
            siteTitle: '{{ config.site_title if config else "Научный Портал" }}'
        };

        function updateAllLogos() {
            const theme = document.documentElement.getAttribute('data-theme') || 'light';
            const logoSrc = theme === 'light' ? siteConfig.logoDark : siteConfig.logoLight;

            // Update all logo elements
            const logos = document.querySelectorAll('.header-logo, .admin-logo, .plugin-logo, .login-logo');
            logos.forEach(logo => {
                if (logo) {
                    logo.src = logoSrc;
                }
            });
        }

        document.addEventListener('DOMContentLoaded', updateAllLogos);

        // Watch for theme changes
        const themeObserver = new MutationObserver(updateAllLogos);
        themeObserver.observe(document.documentElement, { attributes: true, attributeFilter: ['data-theme'] });
    </script>
    {% block extra_js %}{% endblock %}
</body>
</html>
